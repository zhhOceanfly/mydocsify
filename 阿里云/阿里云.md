# 阿里云实施

## 阿里云配置RAM用户
- vrworld@1671233740866481.onaliyun.com TellhowXR%%-=Vrworld
- 创建RAM子账号
- 创建资源组
- 分配子账号资源组权限
  - 分配rds资源
  - 分配ecs资源
  - 分配域名资源
  - 分配cdn资源
  - 配置ssl资源
  - 分配费用账单权限

## 配置静态网站托管
- 配置官网步骤：
  ```
  - oss配置bucket
  - 自定义域名绑定
  - cdn加速
  - 修改域名cname
  - https证书
  - 强制跳转
  - 重写访问url
  - 私有bucket回源
  - todo:
      - 是否开启自动cdn刷新？
      - 是否开启cdn防刷？
  ```

## 配置docker镜像站
- 阿里云容器镜像
  ```纯文本
  - 开通个人版镜像站
  - 创建镜像仓库
  - 创建命名空间
  - 上传镜像到阿里云
    #公司阿里云
        docker login --username=taihaovr registry.cn-hangzhou.aliyuncs.com
        docker pull registry.cn-hangzhou.aliyuncs.com/tellhowxr/gitea:1.21.8
        docker tag gitea/gitea:1.21.8 registry.cn-hangzhou.aliyuncs.com/tellhowxr/gitea:1.21.8
        docker push registry.cn-hangzhou.aliyuncs.com/tellhowxr/gitea:1.21.8
    #个人阿里云
        docker login --username=15297945060 registry.cn-qingdao.aliyuncs.com
        docker tag gitea/gitea:1.21.8 registry.cn-qingdao.aliyuncs.com/oceanfly-hub/gitea:0.1
        docker push registry.cn-qingdao.aliyuncs.com/oceanfly-hub/gitea:0.1
  ```


## ssh登录阿里云服务器
  ```纯文本
  - ssh登陆
    ssh -i "C:\Users\zhh\.ssh\thvr@60.205.58.214.key" root@60.205.58.214 -p 22
    ssh-keygen -R 60.205.58.214
    ssh-keygen -t rsa
      #输入oceanfly@60.205.58.214.key
    使用ssh-copy-id或者手动拷贝公钥文件到远程服务器的authorized_keys即可
      ssh-copy-id -i "/c/Users/zhh/.ssh/oceanfly@60.205.58.214.pub" "root@60.205.58.214"
    ssh -i /oceanfly@60.205.58.214.key root@60.205.58.214
    ssh -T 60.205.58.214
  ```

## [**阿里云盘扩容**](https://help.aliyun.com/zh/ecs/user-guide/extend-the-partitions-and-file-systems-of-disks-on-a-linux-instance "阿里云盘扩容")
  - 在ECS控制台扩容云盘容量
  - 登录ECS实例内部扩容分区和文件系统
  ```纯文本
  cat /etc/centos-release
    #CentOS Linux release 7.6.1810 (Core)
  sudo fdisk -lu
    #Disk label type值为dos表示MBR分区，值为gpt表示GPT分区
    #如果您的云盘分区类型为MBR且在控制台扩容后容量大于2 TiB，需先转换分区为GPT分区
    #转换linux数据盘的分区类型
      type sgdisk || yum install -y gdisk
      sgdisk -g /dev/vdb1
      fdisk -lu /dev/vdb
   #MBR扩容分区 ，输出CHANGED字样时，表示分区扩容成功
    type growpart || sudo yum install -y cloud-utils-growpart
    sudo LC_ALL=en_US.UTF-8 growpart /dev/vdb1
    #LC_ALL=en_US.UTF-8是环境变量设置，为了兼容中文操作系统的字符编码
   #ext*扩容文件系统 
    df -Th
    sudo resize2fs /dev/vdb1
  #问题
    #运行locale命令查看ECS实例的字符编码类型，将非en_US.UTF-8的字符编码类型切换成en_US.UTF-8
    export LANG=en_US.UTF-8
    export LC_ALL=en_US.UTF-8

  ```
  ![](../image/阿里云磁盘扩容.png)